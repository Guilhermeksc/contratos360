<div class="uasg-search-container">
  <!-- Cabeçalho e Filtros -->
  <app-page-header
    title="Controle de Contratos"
    [showThemeToggle]="true"
    [isDarkTheme]="isDarkTheme()"
    (themeToggle)="onThemeToggle($event)">

    <button
      headerLeading
      type="button"
      class="exportar-xlsx-button"
      (click)="exportarContratosXlsx()"
      [disabled]="filteredPreviewData().length === 0"
      aria-label="Exportar XLSX"
      title="Exportar XLSX">
      <img src="assets/img/svg/excel.svg" alt="" />
    </button>
    
    <!-- Controles do header (filtros, etc.) -->
    <div headerControls>
      <app-combobox
        [value]="selectedUasgFilter"
        [options]="getUasgOptions()"
        placeholder="Todas as UASGs"
        trackBy="value"
        [displayFn]="getUasgOptionLabel"
        (valueChange)="onUasgFilterValueChange($event)">
      </app-combobox>
      
      <app-filtro-busca
        [value]="searchTerm()"
        (valueChange)="onSearchChange($event)"
        placeholder="Digite o texto para buscar...">
      </app-filtro-busca>
    </div>
    
    <!-- Conteúdo abaixo do header (tabela, etc.) -->
    <div headerContent class="table-container">
      <app-preview-table 
        [data]="filteredPreviewData()"
        [isDarkTheme]="isDarkTheme()"
        (rowClick)="showRecordPopupHandler($event)"
      ></app-preview-table>
    </div>
  </app-page-header>

  <!-- Popup de Registros -->
  <app-record-popup
    [contratoId]="selectedContratoId()"
    [mostrar]="showRecordPopup()"
    (fechar)="closeRecordPopup()"
    (saved)="onRecordSaved()">
  </app-record-popup>
</div>

